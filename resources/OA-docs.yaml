openapi: 3.0.0
info:
  title: Grainvision API
  version: 1.0.0
  description: |+




  contact:
    name: IEA
    email: a@j.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  x-logo:
    url: ''
servers:
  - url: http://grainvision.local
    description: ''
paths:
  /api/administration/roles-permissions:
    summary: Get roles and permissions.
    description: Get an array with all the roles and its permissions.
    get:
      tags:
        - Administration
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                required:
                  - roles
                  - permissions
                type: object
                properties:
                  roles:
                    minItems: 1
                    uniqueItems: true
                    type: array
                    items:
                      required:
                        - name
                      properties:
                        name:
                          minLength: 1
                          type: string
                        permissions:
                          type: array
                  permissions:
                    minItems: 1
                    uniqueItems: true
                    type: array
                    items:
                      required:
                        - name
                      properties:
                        name:
                          minLength: 1
                          type: string
                externalDocs:
                  description: ''
                  url: ''
                example: ''
                x-examples:
                  example-1:
                    roles:
                      - name: super-admin
                        permissions: []
                      - name: administrator
                        permissions:
                          - name: dashboard
                          - name: facilities
                          - name: facilities.status
                          - name: facilities.overview
                          - name: facilities.view
                          - name: facilities.container.status
                          - name: facilities.container.truss.status
                          - name: facilities.container.cable.chart
                          - name: facilities.container.cable.truss.chart
                          - name: facilities.container.cable.sensor.chart
                          - name: facilities.container.truss.cable.sensor.chart
                          - name: facilities.historics.store
                          - name: administration
                          - name: administration.users
                          - name: administration.users.index
                          - name: administration.users.create
                          - name: administration.users.edit
                          - name: administration.users.update
                          - name: administration.users.delete
                          - name: administration.facilities
                          - name: administration.facilities.index
                          - name: administration.facilities.create
                          - name: administration.facilities.edit
                          - name: administration.facilities.update
                          - name: administration.facilities.delete
                      - name: standard
                        permissions:
                          - name: facilities.view
                          - name: facilities.container.status
                          - name: facilities.container.truss.status
                          - name: facilities.container.cable.chart
                          - name: facilities.container.cable.truss.chart
                          - name: facilities.container.cable.sensor.chart
                          - name: facilities.container.truss.cable.sensor.chart
                      - name: supervisor
                        permissions:
                          - name: facilities.status
                          - name: facilities.overview
                          - name: facilities.view
                          - name: facilities.container.status
                          - name: facilities.container.truss.status
                          - name: facilities.container.cable.chart
                          - name: facilities.container.cable.truss.chart
                          - name: facilities.container.cable.sensor.chart
                          - name: facilities.container.truss.cable.sensor.chart
                          - name: facilities.historics.store
                      - name: regional_manager
                        permissions:
                          - name: dashboard
                          - name: facilities
                          - name: facilities.status
                          - name: facilities.overview
                          - name: facilities.view
                          - name: facilities.container.status
                          - name: facilities.container.truss.status
                          - name: facilities.container.cable.chart
                          - name: facilities.container.cable.truss.chart
                          - name: facilities.container.cable.sensor.chart
                          - name: facilities.container.truss.cable.sensor.chart
                          - name: facilities.historics.store
                      - name: gvcloud
                        permissions:
                          - name: facilities.historics.store
                    permissions:
                      - name: dashboard
                      - name: facilities
                      - name: facilities.status
                      - name: facilities.overview
                      - name: facilities.view
                      - name: facilities.container.status
                      - name: facilities.container.truss.status
                      - name: facilities.container.cable.chart
                      - name: facilities.container.cable.truss.chart
                      - name: facilities.container.cable.sensor.chart
                      - name: facilities.container.truss.cable.sensor.chart
                      - name: facilities.historics.store
                      - name: administration
                      - name: administration.users
                      - name: administration.users.index
                      - name: administration.users.create
                      - name: administration.users.edit
                      - name: administration.users.update
                      - name: administration.users.delete
                      - name: administration.facilities
                      - name: administration.facilities.index
                      - name: administration.facilities.create
                      - name: administration.facilities.edit
                      - name: administration.facilities.update
                      - name: administration.facilities.delete
              example: ''
          description: Succesful operation
      operationId: getRolesAndPermissions
      summary: Get roles and permissions
      description: Get a list of all roles and permissions
    x-last-modified: 1638272492399
  /api/facilities:
    summary: Get facilities.
    description: Get all the facilities for the user.
    get:
      tags:
        - Facilities
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                minItems: 1
                uniqueItems: true
                type: array
                items:
                  $ref: '#/components/schemas/Facility'
                externalDocs:
                  description: ''
                  url: ''
                example: ''
                x-examples:
                  example-1:
                    - id: 6
                      nombre: GV3679
                      descripcion: Cargill APS
                      version: 3.5.10
                      seeded: '2021-10-25 11:58:30'
                      history_days: '365'
                      created_at: '2021-10-25 11:55:25'
                      updated_at: '2021-11-03 10:23:00'
              example: ''
          description: Succesful operation.
      operationId: getFacilities
      summary: Get facilities.
      description: Get a list with all the facilities for a user.
    x-last-modified: 1638272575470
  /api/facilities/{proyecto}:
    summary: Get a facility.
    description: Get information about a specific facility.
    get:
      tags:
        - Facilities
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Facility'
          description: Succesful operation.
      operationId: getFacility
      summary: Get facility.
      description: Get a specific facility.
    parameters:
      - $ref: '#/components/parameters/proyecto'
        name: proyecto
        x-last-modified: 1638184958406
    x-last-modified: 1638272608786
  /api/facilities/{proyecto}/containers:
    summary: Get containers.
    description: Get an array with all the containers in a facility.
    get:
      tags:
        - Facilities
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Containers'
          description: Succesful operation.
      operationId: getConteiners
      summary: Get containers.
      description: Get all containers of a specific facility.
    parameters:
      - $ref: '#/components/parameters/proyecto'
        name: proyecto
        x-last-modified: 1638184979121
    x-last-modified: 1638272639720
  /api/facilities/{proyecto}/summary:
    summary: Get summary.
    description: Get the summary of a facility.
    get:
      tags:
        - Facilities
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                required:
                  - sensors
                  - summaries
                type: object
                properties:
                  sensors:
                    type: number
                  summaries:
                    type: array
                    items: {}
                x-examples:
                  example-1:
                    sensors: 8104
                    summaries: []
          description: Succesful operation.
      operationId: getSummary
      summary: Get summary of a facility.
      description: Get a summary of a facility.
    parameters:
      - $ref: '#/components/parameters/proyecto'
        name: proyecto
        x-last-modified: 1638184990619
    x-last-modified: 1638272658321
  /api/login:
    summary: Log in.
    description: Log user into the app with username and password.
    post:
      requestBody:
        description: Enter user credentials.
        content:
          application/json:
            schema:
              description: ''
              required:
                - email
                - password
              type: object
              properties:
                email:
                  minLength: 1
                  type: string
                password:
                  minLength: 1
                  type: string
              x-examples:
                example-1:
                  email: admin@grainvision.com.ar
                  password: secret
        required: true
      tags:
        - Authentication
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                required:
                  - token
                  - token_type
                  - expires_in
                type: object
                properties:
                  token:
                    minLength: 1
                    type: string
                  token_type:
                    minLength: 1
                    type: string
                  expires_in:
                    type: number
                x-examples:
                  example-1:
                    token: >-
                      eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9ncmFpbnZpc2lvbi5sb2NhbFwvYXBpXC9sb2dpbiIsImlhdCI6MTYzNzkyNzMxNSwiZXhwIjoxNjM4MDEzNzE1LCJuYmYiOjE2Mzc5MjczMTUsImp0aSI6IldiS0pwSFYyU1NIeDFEUGoiLCJzdWIiOjEsInBydiI6Ijg3ZTBhZjFlZjlmZDE1ODEyZmRlYzk3MTUzYTE0ZTBiMDQ3NTQ2YWEifQ.5_XcJNvblIHVvcsAj4ZzNr1UlbZO93UEYtikTCg5BCU
                    token_type: bearer
                    expires_in: 86400
          description: Succesful operation.
        '400':
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Already authenticated.
          description: Already authenticated.
        '422':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The given data was invalid
                  errors:
                    type: object
                    example:
                      email: These credentials do not match our records.
          description: Invalid credentials.
      operationId: postLogin
      summary: Log In.
      description: Log in with username and password.
    x-last-modified: 1638272691871
  /api/logout:
    summary: Log out.
    description: Log out of the app.
    post:
      tags:
        - Authentication
      responses:
        '200':
          description: Succesful operation.
      operationId: postLogout
      summary: Log Out.
      description: Log out user.
    x-last-modified: 1638272708281
  /api/settings/password:
    summary: Update password.
    description: Update the password for a user.
    patch:
      requestBody:
        description: Enter and confirm new password.
        content:
          application/json:
            schema:
              description: ''
              required:
                - password
                - password_confirmation
              type: object
              properties:
                password:
                  minLength: 1
                  type: string
                password_confirmation:
                  minLength: 1
                  type: string
              x-examples:
                example-1:
                  password: secret
                  password_confirmation: secret
        required: true
      tags:
        - Settings
      responses:
        '200':
          description: Succesful operation.
      operationId: patchPassword
      summary: Change password.
      description: Update user's password
    x-last-modified: 1638272741040
  /api/settings/profile:
    summary: Update profile.
    description: Update username and email of a user.
    patch:
      requestBody:
        description: Enter username and password.
        content:
          application/json:
            schema:
              description: ''
              required:
                - name
                - email
              type: object
              properties:
                name:
                  minLength: 1
                  type: string
                email:
                  minLength: 1
                  type: string
              x-examples:
                example-1:
                  name: fede
                  email: admin@grainvision.com.ar
        required: true
      tags:
        - Settings
      responses:
        '200':
          description: Succesful operation.
      operationId: patchProfile
      summary: Change user info
      description: Update username and email.
    x-last-modified: 1638272766004
  /api/user:
    summary: Get user.
    description: Get information about the user.
    get:
      tags:
        - Settings
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                required:
                  - id
                  - name
                  - email
                  - created_at
                  - updated_at
                  - photo_url
                  - permissions
                  - roles
                type: object
                properties:
                  id:
                    type: number
                  name:
                    minLength: 1
                    type: string
                  email:
                    minLength: 1
                    type: string
                  email_verified_at: {}
                  created_at:
                    minLength: 1
                    type: string
                  updated_at:
                    minLength: 1
                    type: string
                  photo_url:
                    minLength: 1
                    type: string
                  permissions:
                    minItems: 1
                    uniqueItems: true
                    type: array
                    items:
                      required:
                        - name
                      properties:
                        name:
                          minLength: 1
                          type: string
                  roles:
                    minItems: 1
                    uniqueItems: true
                    type: array
                    items:
                      required:
                        - name
                      properties:
                        name:
                          minLength: 1
                          type: string
                        permissions:
                          type: array
                          items: {}
                x-examples:
                  example-1:
                    id: 1
                    name: fede
                    email: admin@grainvision.com.ar
                    created_at: '2021-10-04 09:24:59'
                    updated_at: '2021-11-16 10:55:24'
                    photo_url: >-
                      https://www.gravatar.com/avatar/549dd0ad5839708b235682769d181cc4.jpg?s=200&d=mm
                    permissions:
                      - name: dashboard
                      - name: facilities
                      - name: facilities.status
                      - name: facilities.overview
                      - name: facilities.view
                      - name: facilities.container.status
                      - name: facilities.container.truss.status
                      - name: facilities.container.cable.chart
                      - name: facilities.container.cable.truss.chart
                      - name: facilities.container.cable.sensor.chart
                      - name: facilities.container.truss.cable.sensor.chart
                      - name: facilities.historics.store
                      - name: administration
                      - name: administration.users
                      - name: administration.users.index
                      - name: administration.users.create
                      - name: administration.users.edit
                      - name: administration.users.update
                      - name: administration.users.delete
                      - name: administration.facilities
                      - name: administration.facilities.index
                      - name: administration.facilities.create
                      - name: administration.facilities.edit
                      - name: administration.facilities.update
                      - name: administration.facilities.delete
                    roles:
                      - name: super-admin
                        permissions: []
          description: Succesful operation.
        '401':
          description: Not authenticated.
      operationId: getUser
      summary: Get user
      description: Get all user info.
    x-last-modified: 1638272783521
  /api/oauth/{driver}/callback:
    summary: oAuth callback
    get:
      tags:
        - Authentication
      operationId: oauth-driver-callback
      summary: oAuth driver callback.
    x-last-modified: 1638364382577
  /api/oauth2-callback:
    summary: oAuth 2 callback
    get:
      tags:
        - Authentication
      operationId: oauth2-callback
      summary: oAuth 2 callback.
    x-last-modified: 1638364388602
  /api/oauth/{driver}:
    summary: oAuth.
    post:
      tags:
        - Authentication
      operationId: oauth-driver
      summary: oAuth driver.
    x-last-modified: 1638364394562
  /api/password/reset:
    summary: Reset password
    post:
      tags:
        - Authentication
      operationId: password-reset
      summary: Reset password.
    x-last-modified: 1638364431877
  /api/password/email:
    post:
      tags:
        - Authentication
      operationId: password-email
      summary: Email for password.
    x-last-modified: 1638364438824
  /api/administration/facilities:
    summary: Facilities in administration.
    description: All operations to manage facilities with the administrative roles.
    get:
      tags:
        - Administration
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                type: array
                items:
                  $ref: '#/components/schemas/Facility'
                externalDocs:
                  description: ''
                  url: ''
                example: ''
              example: ''
          description: Succesful operation.
      operationId: get-administration-facilities
      summary: Get facilities
      description: >-
        Get an array that displays all the existent facilities, with all their
        data.
    post:
      requestBody:
        required: true
      tags:
        - Administration
      responses:
        '200':
          description: Succesful operation.
          x-last-modified: 1638185646080
      operationId: post-administration-facilities
      summary: Store facility.
      description: |-
        Store a new facility into the database.
        The information of the new facility has to be provided from a file.
    x-last-modified: 1638364451460
  /api/administration/facilities/{facility}:
    summary: Get a particular facility.
    description: Get all information about a facility, providing its ID as a parameter.
    get:
      tags:
        - Administration
      responses:
        Facility:
          description: An object that contains all the information of the facility.
          x-last-modified: 1638359935829
      operationId: get-facility
      summary: Get a particular facility.
      description: Get all information about a facility, providing its ID as a parameter.
    put:
      tags:
        - Administration
      responses:
        facility:
          content:
            application/json:
              schema:
                description: ''
                type: object
                properties:
                  id:
                    type: number
                  nombre:
                    type: string
                  descripcion:
                    type: string
                  version:
                    type: string
                  seeded:
                    type: string
                  history_days:
                    type: string
                  created_at:
                    type: string
                  updated_at:
                    type: string
                externalDocs:
                  description: ''
                  url: ''
                example: ''
              example: ''
          description: ''
          x-last-modified: 1638360577416
      operationId: put-facility
      summary: Update a particular facility.
      description: ''
    delete:
      tags:
        - Administration
      operationId: delete-facility
      summary: Delete a particular facility.
      description: ''
    parameters:
      - $ref: '#/components/parameters/proyecto'
        name: Facility
        x-last-modified: 1638359553017
    x-last-modified: 1638364467394
  /api/administration/users:
    summary: Get all users.
    description: Get an array with all the users and all their information.
    get:
      tags:
        - Administration
      responses:
        '200':
          content:
            application/json:
              schema:
                description: ''
                minItems: 1
                uniqueItems: true
                type: array
                items:
                  required:
                    - id
                    - name
                    - email
                    - created_at
                    - updated_at
                    - photo_url
                    - roles
                    - permissions
                  type: object
                  properties:
                    id:
                      type: number
                    name:
                      minLength: 1
                      type: string
                    email:
                      minLength: 1
                      type: string
                    email_verified_at: {}
                    created_at:
                      minLength: 1
                      type: string
                    updated_at:
                      minLength: 1
                      type: string
                    photo_url:
                      minLength: 1
                      type: string
                    roles:
                      minItems: 1
                      uniqueItems: true
                      type: array
                      items:
                        required:
                          - name
                        properties:
                          name:
                            minLength: 1
                            type: string
                          permissions:
                            type: array
                            items: {}
                    permissions:
                      minItems: 1
                      uniqueItems: true
                      type: array
                      items:
                        required:
                          - name
                        properties:
                          name:
                            minLength: 1
                            type: string
                x-examples:
                  example-1:
                    - id: 1
                      name: fede
                      email: admin@grainvision.com.ar
                      created_at: '2021-10-04 09:24:59'
                      updated_at: '2021-11-16 10:55:24'
                      photo_url: >-
                        https://www.gravatar.com/avatar/549dd0ad5839708b235682769d181cc4.jpg?s=200&d=mm
                      roles:
                        - name: super-admin
                          permissions: []
                      permissions:
                        - name: dashboard
                        - name: facilities
                        - name: facilities.status
                        - name: facilities.overview
                        - name: facilities.view
                        - name: facilities.container.status
                        - name: facilities.container.truss.status
                        - name: facilities.container.cable.chart
                        - name: facilities.container.cable.truss.chart
                        - name: facilities.container.cable.sensor.chart
                        - name: facilities.container.truss.cable.sensor.chart
                        - name: facilities.historics.store
                        - name: administration
                        - name: administration.users
                        - name: administration.users.index
                        - name: administration.users.create
                        - name: administration.users.edit
                        - name: administration.users.update
                        - name: administration.users.delete
                        - name: administration.facilities
                        - name: administration.facilities.index
                        - name: administration.facilities.create
                        - name: administration.facilities.edit
                        - name: administration.facilities.update
                        - name: administration.facilities.delete
          description: OK
      operationId: get-api-administration-users
      summary: Get all users.
      description: Get an array with all the users.
    x-last-modified: 1638364473815
  /api/administration/users/{user}:
    summary: Manage a particular user.
    description: Get information, update, or delete a particular user provided in the path.
    get:
      tags:
        - Administration
      operationId: get-user-admin
      summary: Get information about a user.
    put:
      tags:
        - Administration
      operationId: update-user-admin
      summary: Update information of a user.
    delete:
      tags:
        - Administration
      operationId: delete-user-admin
      summary: Delete a user.
    x-last-modified: 1638364479418
  /api/administration/{proyecto}/representation:
    summary: Representation of a facility.
    description: Add or delete the representation of a facility.
    post:
      tags:
        - Administration
      operationId: post-representation
      summary: Store the representation of a facility.
    delete:
      tags:
        - Administration
      operationId: delete-representation
      summary: Delete the representation of a facility.
    x-last-modified: 1638364484503
  /api/email/resend:
    summary: Resend email.
    post:
      tags:
        - Authentication
      operationId: email-resend
      summary: Resend email.
    x-last-modified: 1638364492026
  /api/email/verify/{user}:
    summary: Verify user's email.
    post:
      tags:
        - Authentication
      operationId: email-verify
      summary: Verify user's email.
    x-last-modified: 1638364497712
components:
  schemas:
    Facility:
      description: ''
      required:
        - id
        - nombre
        - descripcion
        - version
        - seeded
        - history_days
        - created_at
        - updated_at
      type: object
      properties:
        id:
          type: number
        nombre:
          minLength: 1
          type: string
        descripcion:
          minLength: 1
          type: string
        version:
          minLength: 1
          type: string
        seeded:
          minLength: 1
          type: string
        history_days:
          minLength: 1
          type: string
        created_at:
          minLength: 1
          type: string
        updated_at:
          minLength: 1
          type: string
      x-examples:
        example-1:
          id: 6
          nombre: GV3679
          descripcion: Company SA
          version: 3.5.10
          seeded: '2021-10-25 11:58:30'
          history_days: '365'
          created_at: '2021-10-25 11:55:25'
          updated_at: '2021-11-03 10:23:00'
    Containers:
      description: ''
      required:
        - id
        - contenedor_tipo_id
        - tag
        - tipo
      type: object
      properties:
        id:
          type: number
        parent_id: {}
        contenedor_tipo_id:
          type: number
        tag:
          minLength: 1
          type: string
        tipo:
          required:
            - id
            - tipo
            - letra
          type: object
          properties:
            id:
              type: number
            tipo:
              minLength: 1
              type: string
            letra:
              minLength: 1
              type: string
      x-examples:
        example-1:
          id: 41
          contenedor_tipo_id: 2
          tag: G001
          tipo:
            id: 2
            tipo: Celda
            letra: G
  parameters:
    proyecto:
      deprecated: false
      name: proyecto
      description: Name of the desired facility.
      schema:
        format: text
        description: Name of the facility.
        type: string
      in: path
      required: true
      x-last-modified: 1638184902784
  securitySchemes:
    JWTAuth:
      scheme: bearer
      bearerFormat: JWT
      type: http
      description: |-
        Example: 
        > Authorization: Bearer <token>
      x-last-modified: 1638367145842
    oAuth:
      scheme: oauth
      type: http
      description: ''
      x-last-modified: 1638369689662
    oAuth 2:
      flows:
        implicit:
          authorizationUrl: ''
          refreshUrl: ''
        password:
          tokenUrl: ''
          refreshUrl: ''
        clientCredentials:
          tokenUrl: ''
          refreshUrl: ''
        authorizationCode:
          authorizationUrl: ''
          tokenUrl: ''
          refreshUrl: ''
      type: oauth2
      description: ''
      x-last-modified: 1638369702743
  headers: {}
  responses: {}
security:
  - JWTAuth: []
  - oAuth: []
  - oAuth 2: []
tags:
  - name: Administration
    description: All the operations that are allowed for the administrative roles.
    x-last-modified: 1638358204949
  - name: Authentication
    description: All the operations that manage the authentication of a user.
    x-last-modified: 1638358252455
  - name: Facilities
    description: >-
      All the operations that are related to facilities for non-administrative
      roles.
    x-last-modified: 1638358303353
  - name: Settings
    description: All the operations that provide and update information about a user.
    x-last-modified: 1638358358227
